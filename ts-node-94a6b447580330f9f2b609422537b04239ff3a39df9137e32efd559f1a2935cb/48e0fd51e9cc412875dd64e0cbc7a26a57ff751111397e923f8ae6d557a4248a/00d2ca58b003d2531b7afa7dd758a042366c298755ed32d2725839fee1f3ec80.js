"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var fs = require("fs");
var protractor_1 = require("protractor");
var products_wg_1 = require("./products/products.wg");
var search_wg_1 = require("./common/search/search.wg");
var productModel_wg_1 = require("./products/productModel.wg");
var cart_wg_1 = require("./common/cart/cart.wg");
var cartModal_wg_1 = require("./common/cart/cartModal.wg");
function screen(name) {
    protractor_1.browser.takeScreenshot()
        .then(function (png) {
        var stream = fs.createWriteStream("./" + name + ".png");
        stream.write(new Buffer(png, 'base64'));
        stream.end();
    });
}
describe('angular-course App', function () {
    var productsWidget = new products_wg_1.ProductsWidget();
    var searchWidget = new search_wg_1.SearchWidget();
    var productsModalWidget = new productModel_wg_1.ProductsModalWidget();
    var cartWidget = new cart_wg_1.CartWidget();
    var cartModalWidget = new cartModal_wg_1.CartModalWidget();
    beforeEach(function () {
        protractor_1.browser.get('/');
    });
    it('should search by term', function () {
        searchWidget.search('DRAGBOTasdasdasdasd');
        expect(productsWidget.cards.count())
            .toEqual(0);
        //
        searchWidget.searchInput.clear();
        searchWidget.search('DRAGBOT');
        expect(productsWidget.cards.count())
            .toEqual(1);
        screen('img');
    });
    it('should display card modal', function () {
        productsWidget.openFullCard(3);
        expect(productsModalWidget.title.getText())
            .toEqual('BARKARAMA');
        expect(productsModalWidget.price.getText())
            .toEqual('1951.37');
        screen('img1');
    });
    it('should add to product cart and remove', function () {
        [1, 3, 7].forEach(function (index) {
            productsWidget.openFullCard(index);
            productsModalWidget.buy();
        });
        expect(cartWidget.counter.getText())
            .toEqual('3');
        screen('img2');
        cartWidget.openCart();
        [0, 1, 2].forEach(function (index) {
            screen("img" + index + "remove");
            cartModalWidget.removeFromCart(0);
        });
        expect(cartWidget.counter)
            .toBeDefined(false);
        screen('img3');
    });
    it('should not open empty cart ', function () {
        cartWidget.openCart();
        expect(cartModalWidget.cartModal)
            .toBeDefined(false);
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiL3Zhci93d3cvYW5ndWxhci1jb3Vyc2UvZTJlL2FwcC5lMmUtc3BlYy50cyIsInNvdXJjZXMiOlsiL3Zhci93d3cvYW5ndWxhci1jb3Vyc2UvZTJlL2FwcC5lMmUtc3BlYy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLHVCQUF5QjtBQUN6Qix5Q0FBcUM7QUFFckMsc0RBQXdEO0FBQ3hELHVEQUF5RDtBQUN6RCw4REFBaUU7QUFDakUsaURBQW1EO0FBQ25ELDJEQUE2RDtBQUU3RCxnQkFBZ0IsSUFBWTtJQUMxQixvQkFBTyxDQUFDLGNBQWMsRUFBRTtTQUNyQixJQUFJLENBQUMsVUFBQyxHQUFXO1FBQ2hCLElBQU0sTUFBTSxHQUFtQixFQUFFLENBQUMsaUJBQWlCLENBQUMsT0FBSyxJQUFJLFNBQU0sQ0FBQyxDQUFDO1FBQ3JFLE1BQU0sQ0FBQyxLQUFLLENBQUMsSUFBSSxNQUFNLENBQUMsR0FBRyxFQUFFLFFBQVEsQ0FBQyxDQUFDLENBQUM7UUFDeEMsTUFBTSxDQUFDLEdBQUcsRUFBRSxDQUFDO0lBQ2YsQ0FBQyxDQUFDLENBQUM7QUFDUCxDQUFDO0FBRUQsUUFBUSxDQUFDLG9CQUFvQixFQUFFO0lBRTdCLElBQU0sY0FBYyxHQUFtQixJQUFJLDRCQUFjLEVBQUUsQ0FBQztJQUM1RCxJQUFNLFlBQVksR0FBaUIsSUFBSSx3QkFBWSxFQUFFLENBQUM7SUFDdEQsSUFBTSxtQkFBbUIsR0FBd0IsSUFBSSxxQ0FBbUIsRUFBRSxDQUFDO0lBQzNFLElBQU0sVUFBVSxHQUFlLElBQUksb0JBQVUsRUFBRSxDQUFDO0lBQ2hELElBQU0sZUFBZSxHQUFvQixJQUFJLDhCQUFlLEVBQUUsQ0FBQztJQUUvRCxVQUFVLENBQUM7UUFDVCxvQkFBTyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQztJQUNuQixDQUFDLENBQUMsQ0FBQztJQUVILEVBQUUsQ0FBQyx1QkFBdUIsRUFBRTtRQUMxQixZQUFZLENBQUMsTUFBTSxDQUFDLHFCQUFxQixDQUFDLENBQUM7UUFDM0MsTUFBTSxDQUFDLGNBQWMsQ0FBQyxLQUFLLENBQUMsS0FBSyxFQUFFLENBQUM7YUFDakMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ2QsRUFBRTtRQUNGLFlBQVksQ0FBQyxXQUFXLENBQUMsS0FBSyxFQUFFLENBQUM7UUFHakMsWUFBWSxDQUFDLE1BQU0sQ0FBQyxTQUFTLENBQUMsQ0FBQztRQUMvQixNQUFNLENBQUMsY0FBYyxDQUFDLEtBQUssQ0FBQyxLQUFLLEVBQUUsQ0FBQzthQUNqQyxPQUFPLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFFZCxNQUFNLENBQUMsS0FBSyxDQUFDLENBQUM7SUFDaEIsQ0FBQyxDQUFDLENBQUM7SUFFSCxFQUFFLENBQUMsMkJBQTJCLEVBQUU7UUFDOUIsY0FBYyxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUMvQixNQUFNLENBQUMsbUJBQW1CLENBQUMsS0FBSyxDQUFDLE9BQU8sRUFBRSxDQUFDO2FBQ3hDLE9BQU8sQ0FBQyxXQUFXLENBQUMsQ0FBQztRQUN4QixNQUFNLENBQUMsbUJBQW1CLENBQUMsS0FBSyxDQUFDLE9BQU8sRUFBRSxDQUFDO2FBQ3hDLE9BQU8sQ0FBQyxTQUFTLENBQUMsQ0FBQztRQUN0QixNQUFNLENBQUMsTUFBTSxDQUFDLENBQUM7SUFDakIsQ0FBQyxDQUFDLENBQUM7SUFFSCxFQUFFLENBQUMsdUNBQXVDLEVBQUU7UUFDMUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxVQUFDLEtBQWE7WUFDOUIsY0FBYyxDQUFDLFlBQVksQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUNuQyxtQkFBbUIsQ0FBQyxHQUFHLEVBQUUsQ0FBQztRQUM1QixDQUFDLENBQUMsQ0FBQztRQUNILE1BQU0sQ0FBQyxVQUFVLENBQUMsT0FBTyxDQUFDLE9BQU8sRUFBRSxDQUFDO2FBQ2pDLE9BQU8sQ0FBQyxHQUFHLENBQUMsQ0FBQztRQUNoQixNQUFNLENBQUMsTUFBTSxDQUFDLENBQUM7UUFFZixVQUFVLENBQUMsUUFBUSxFQUFFLENBQUM7UUFDdEIsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxVQUFDLEtBQWE7WUFDOUIsTUFBTSxDQUFDLFFBQU0sS0FBSyxXQUFRLENBQUMsQ0FBQztZQUM1QixlQUFlLENBQUMsY0FBYyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ3BDLENBQUMsQ0FBQyxDQUFDO1FBRUgsTUFBTSxDQUFDLFVBQVUsQ0FBQyxPQUFPLENBQUM7YUFDdkIsV0FBVyxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBRXRCLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQztJQUNqQixDQUFDLENBQUMsQ0FBQztJQUNILEVBQUUsQ0FBQyw2QkFBNkIsRUFBRTtRQUNoQyxVQUFVLENBQUMsUUFBUSxFQUFFLENBQUM7UUFDdEIsTUFBTSxDQUFDLGVBQWUsQ0FBQyxTQUFTLENBQUM7YUFDOUIsV0FBVyxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQ3hCLENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBmcyBmcm9tICdmcyc7XG5pbXBvcnQgeyBicm93c2VyIH0gZnJvbSAncHJvdHJhY3Rvcic7XG5cbmltcG9ydCB7IFByb2R1Y3RzV2lkZ2V0IH0gZnJvbSAnLi9wcm9kdWN0cy9wcm9kdWN0cy53Zyc7XG5pbXBvcnQgeyBTZWFyY2hXaWRnZXQgfSBmcm9tICcuL2NvbW1vbi9zZWFyY2gvc2VhcmNoLndnJztcbmltcG9ydCB7IFByb2R1Y3RzTW9kYWxXaWRnZXQgfSBmcm9tICcuL3Byb2R1Y3RzL3Byb2R1Y3RNb2RlbC53Zyc7XG5pbXBvcnQgeyBDYXJ0V2lkZ2V0IH0gZnJvbSAnLi9jb21tb24vY2FydC9jYXJ0LndnJztcbmltcG9ydCB7IENhcnRNb2RhbFdpZGdldCB9IGZyb20gJy4vY29tbW9uL2NhcnQvY2FydE1vZGFsLndnJztcblxuZnVuY3Rpb24gc2NyZWVuKG5hbWU6IHN0cmluZyk6IHZvaWQge1xuICBicm93c2VyLnRha2VTY3JlZW5zaG90KClcbiAgICAudGhlbigocG5nOiBzdHJpbmcpID0+IHtcbiAgICAgIGNvbnN0IHN0cmVhbTogZnMuV3JpdGVTdHJlYW0gPSBmcy5jcmVhdGVXcml0ZVN0cmVhbShgLi8ke25hbWV9LnBuZ2ApO1xuICAgICAgc3RyZWFtLndyaXRlKG5ldyBCdWZmZXIocG5nLCAnYmFzZTY0JykpO1xuICAgICAgc3RyZWFtLmVuZCgpO1xuICAgIH0pO1xufVxuXG5kZXNjcmliZSgnYW5ndWxhci1jb3Vyc2UgQXBwJywgKCkgPT4ge1xuXG4gIGNvbnN0IHByb2R1Y3RzV2lkZ2V0OiBQcm9kdWN0c1dpZGdldCA9IG5ldyBQcm9kdWN0c1dpZGdldCgpO1xuICBjb25zdCBzZWFyY2hXaWRnZXQ6IFNlYXJjaFdpZGdldCA9IG5ldyBTZWFyY2hXaWRnZXQoKTtcbiAgY29uc3QgcHJvZHVjdHNNb2RhbFdpZGdldDogUHJvZHVjdHNNb2RhbFdpZGdldCA9IG5ldyBQcm9kdWN0c01vZGFsV2lkZ2V0KCk7XG4gIGNvbnN0IGNhcnRXaWRnZXQ6IENhcnRXaWRnZXQgPSBuZXcgQ2FydFdpZGdldCgpO1xuICBjb25zdCBjYXJ0TW9kYWxXaWRnZXQ6IENhcnRNb2RhbFdpZGdldCA9IG5ldyBDYXJ0TW9kYWxXaWRnZXQoKTtcblxuICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICBicm93c2VyLmdldCgnLycpO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIHNlYXJjaCBieSB0ZXJtJywgKCkgPT4ge1xuICAgIHNlYXJjaFdpZGdldC5zZWFyY2goJ0RSQUdCT1Rhc2Rhc2Rhc2Rhc2QnKTtcbiAgICBleHBlY3QocHJvZHVjdHNXaWRnZXQuY2FyZHMuY291bnQoKSlcbiAgICAgIC50b0VxdWFsKDApO1xuICAgIC8vXG4gICAgc2VhcmNoV2lkZ2V0LnNlYXJjaElucHV0LmNsZWFyKCk7XG5cblxuICAgIHNlYXJjaFdpZGdldC5zZWFyY2goJ0RSQUdCT1QnKTtcbiAgICBleHBlY3QocHJvZHVjdHNXaWRnZXQuY2FyZHMuY291bnQoKSlcbiAgICAgIC50b0VxdWFsKDEpO1xuXG4gICAgc2NyZWVuKCdpbWcnKTtcbiAgfSk7XG5cbiAgaXQoJ3Nob3VsZCBkaXNwbGF5IGNhcmQgbW9kYWwnLCAoKSA9PiB7XG4gICAgcHJvZHVjdHNXaWRnZXQub3BlbkZ1bGxDYXJkKDMpO1xuICAgIGV4cGVjdChwcm9kdWN0c01vZGFsV2lkZ2V0LnRpdGxlLmdldFRleHQoKSlcbiAgICAgIC50b0VxdWFsKCdCQVJLQVJBTUEnKTtcbiAgICBleHBlY3QocHJvZHVjdHNNb2RhbFdpZGdldC5wcmljZS5nZXRUZXh0KCkpXG4gICAgICAudG9FcXVhbCgnMTk1MS4zNycpO1xuICAgIHNjcmVlbignaW1nMScpO1xuICB9KTtcblxuICBpdCgnc2hvdWxkIGFkZCB0byBwcm9kdWN0IGNhcnQgYW5kIHJlbW92ZScsICgpID0+IHtcbiAgICBbMSwgMywgN10uZm9yRWFjaCgoaW5kZXg6IG51bWJlcikgPT4ge1xuICAgICAgcHJvZHVjdHNXaWRnZXQub3BlbkZ1bGxDYXJkKGluZGV4KTtcbiAgICAgIHByb2R1Y3RzTW9kYWxXaWRnZXQuYnV5KCk7XG4gICAgfSk7XG4gICAgZXhwZWN0KGNhcnRXaWRnZXQuY291bnRlci5nZXRUZXh0KCkpXG4gICAgICAudG9FcXVhbCgnMycpO1xuICAgIHNjcmVlbignaW1nMicpO1xuXG4gICAgY2FydFdpZGdldC5vcGVuQ2FydCgpO1xuICAgIFswLCAxLCAyXS5mb3JFYWNoKChpbmRleDogbnVtYmVyKSA9PiB7XG4gICAgICBzY3JlZW4oYGltZyR7aW5kZXh9cmVtb3ZlYCk7XG4gICAgICBjYXJ0TW9kYWxXaWRnZXQucmVtb3ZlRnJvbUNhcnQoMCk7XG4gICAgfSk7XG5cbiAgICBleHBlY3QoY2FydFdpZGdldC5jb3VudGVyKVxuICAgICAgLnRvQmVEZWZpbmVkKGZhbHNlKTtcblxuICAgIHNjcmVlbignaW1nMycpO1xuICB9KTtcbiAgaXQoJ3Nob3VsZCBub3Qgb3BlbiBlbXB0eSBjYXJ0ICcsICgpID0+IHtcbiAgICBjYXJ0V2lkZ2V0Lm9wZW5DYXJ0KCk7XG4gICAgZXhwZWN0KGNhcnRNb2RhbFdpZGdldC5jYXJ0TW9kYWwpXG4gICAgICAudG9CZURlZmluZWQoZmFsc2UpO1xuICB9KTtcbn0pO1xuIl19